---
title: "L'Europe décroche-t-elle des Etats-Unis ?"

author:
  - name: Xavier Timbeau
    url: https://www.ofce.sciences-po.fr/pages-chercheurs/page.php?id=37
    affiliation: OFCE
    orcid: "0000-0002-6198-5953"
    affiliation-url: https://www.ofce.sciences-po.fr/
date: "05-22-2025"
categories: ["Productivité","Inégalités", "USA","Europe"]
description: Selon le rapport Draghi, l'Europe décroche. Nous proposons une analyse du point de vue des revenus des individus et de leur distribution et non pas marco ou sectorielle comme habituellement. Pour les 50% les plus pauvres, l'Europe est un modèle plus attractif que les Etats-Unis. La France réussit à maintenir un modèle plutôt égalitaire (au prix d'une taxation importante des 1% les plus riches), alors que les Etats-Unis sont marqués par une polarisation extrême. La forte croissance américaine profite surtout aux plus riches et aux très riches, laissant sur le côté une grande partie de la population sans qu'aucun ruissellement ne leur bénéficie.
comments:
  hypothesis: true

bibliography: references.bib
image: image.jpg
---

```{r, include=FALSE}
ofce::init_qmd(local=TRUE)
```

Selon le rapport Draghi [@draghi2024], l'Europe décroche. L'analyse sectorielle, habituelle, conduit à diagnostiquer un retard technologique que l'on peut relier à des facteurs structurels. L'analyse macroéconomique pointe plutôt une mauvaise combinaison de politiques macroéconomiques. Nous proposons ici une analyse du point de vue des revenus des individus et de leur distribution. Du point de vue des 50% les plus pauvres, l'Europe est un modèle plus attractif que les Etats-Unis. La trajectoire de l'Espagne est celle d'un développement réduisant les inégalités alors que les Pays-Bas combinent forte redistribution et croissance partagée. La France réussit à maintenir un modèle plutôt égalitaire (au prix d'une taxation importante des 1% les plus riches), alors que les Etats-Unis sont marqués par une polarisation extrême. La forte croissance américaine profite surtout aux plus riches et aux très riches, laissant sur le côté une grande partie de la population sans qu'aucun ruissellement ne leur bénéficie.

## Le rapport Draghi

```{r, include=FALSE}
oecd <- ofce::source_data("oecd.R") |>
  group_by(year) |>
  filter(year>1980) |>
  mutate(
    clabel = countrycode::countrycode(country, "iso3c", "country.name.fr"),
    clabel = ifelse(country=="EUZ", "Zone euro", clabel),
    us1 = value/value[country=="USA"],
    relus = value/value[country=="USA"]-1) |>
  group_by(country) |>
  mutate(
    label = ifelse(year==max(year), country, NA_character_)) |>
  ungroup() |>
  mutate(
    lline = glue("<b>{round(value/1000,1)} k$</b> (2021, ppp)/an/personne"),
    rline = ifelse(country=="USA", "", glue(" ({ifelse(relus>0, '+','')}{round(relus*100)}% USA)")),
    tooltip = glue("<b>{clabel}</b>
                   {year}
                   {lline}{rline}")   ) |>
  rename(ppp = value) |>
  select(year, country, us1, ppp, label, tooltip) |>
  pivot_longer(cols = c(us1, ppp), names_to = "variable", values_to = "value") |>
  mutate(label = ifelse(!is.na(label)&variable=="us1"&country!="USA", glue("{label} ({round(100*value)}%)"), label))

ggpib <- function(pays, variable) {
  if(variable=="ppp") {
    interactive <- geom_point_interactive(
      aes(tooltip = tooltip, data_id = year, fill = country),
      shape = 21, stroke = 0.25, col = "white", hover_nearest = TRUE)
    ylab <- ylab("PIB, US$2021 ppp par habitant")
    scaley <- scale_y_log10(
      limits = c(25000, 90000),
      labels = scales::label_number(scale=1/1000, suffix="k"),
      guide  = guide_axis_logticks()
    )
  }
  if(variable=="us1") {
    interactive <- geom_point_interactive(
      aes(tooltip = tooltip, data_id = year, fill = country),
      shape = 21, stroke = 0.25, col = "white", hover_nearest = TRUE)
    ylab <- ylab("PIB, US$2021 ppp par habitant, USA = 100%")
    scaley <- scale_y_log10(
      labels = scales::label_number(scale = 100, suffix="%"),
      guide  = guide_axis_logticks()
    )
  }
  ggplot(oecd |> filter(country %in% !!pays,
                        variable %in% !!variable)) +
    aes(year, value, color = country, group = country) +
    geom_line() +
    interactive +
    scale_color_pays("iso3") +
    scale_x_continuous(
      breaks = seq(1980, 2020, by=10),
      expand = expansion(add = c(2,6))) +
    ggrepel::geom_text_repel(aes(label=label),
                             size= 3,
                             hjust = 0,
                             nudge_x = 1.5,
                             max.overlaps = 5,
                             na.rm=TRUE,
                             min.segment.length=0.1,
                             segment.size = 0.1,
                             xlim = c(2024.5, Inf),
                             direction = "y") +
    theme_ofce(
      panel.spacing = unit(12, 'pt'),
      axis.text = marquee::element_marquee(size = rel(0.7)),
      axis.text.x = marquee::element_marquee( hjust = 0, margin = margin(t=0)),
      axis.ticks.length.y = unit(-2, 'pt'),
      strip.text.x = marquee::element_marquee(size=rel(0.7), hjust = 0, width = 0.9),
      strip.text.y = marquee::element_marquee(size=rel(0.7), hjust = 0)) +
    xlab(NULL)+
    ylab+
    scaley +
    guides(color="none", fill="none") +
    ofce::ofce_caption(
      source = "OECD Economic Outlook 116 (EO), téléchargée le 10 mai 2025", ofce = FALSE, author = TRUE,
      code = "https://github.com/xtimbeau/decrochage",
      note = "Le PIB par tête est en dollar constant (2021), en parité de pouvoir d'achat (*GDPVD_CAP*) ; la zone euro est à 17 membres." )
}

plots <- list(
    "USA, EUZ, GB, CHE" = ggpib(c("USA","EUZ", "GBR", "CHE"), "ppp"),
    "DEU, FRA, ITA, ESP, NLD" = ggpib(c("DEU", "FRA", "ITA", "ESP", "NLD"), "ppp"),
    "relatif aux USA" = ggpib(c("USA", "GBR", "CHE","EUZ", "DEU", "FRA", "ITA", "ESP", "NLD"), "us1"))

```

```{r, results="asis"}
#| label: fig-pibcap
#| fig-cap: PIB moyen par habitant
#| fig-asp: 0.7

tabsetize(plots, r=2)
```

```{r, results="asis"}

download_margin(oecd |> select(year, country, variable, value))

```

Publié au printemps 2024, le rapport @draghi2024 a rappelé des éléments connus. Depuis la crise financière de 2008, l'Europe (ici la zone euro) décroche des Etats-Unis lorsqu'on utilise le Produit intérieur brut en volume (donc corrigé de l'inflation[^1]) et en parité de pouvoir d'achat (donc comparable entre zones géographiques[^2]) et par tête (donc corrigé de la démographie[^3]) comme indicateur (@fig-pibcap). Alors que l'écart entre les Etats-Unis et la zone euro n'était que de 14% en 2008, à peu près constant depuis la création de la zone euro, il est aujourd'hui (en 2024) de 25%. Lentement, au rythme d'un peu plus d'un demi point (0,7) par an, la zone euro semble perdre du terrain.

[^1]: Les données considérées sont donc les PIB en valeur, divisés par le déflateur du PIB qui peut différer des indices de prix à la consommation. De nombreuses réserves s'appliquent aux déflateurs et en particulier à leur utilisation pour des comparaisons internationales du fait de méthodes non homogénéisées entre les instituts statistiques.

[^2]: La méthode consiste à utiliser pour une année de base (ici 2021) les indices de parité de pouvoir d'achat construit par la Banque Mondiale à partir de la valeur de paniers de biens et services identiques dans différents pays. Les indices de PPP (ou PPA en français) ne sont pas construits comme les déflateurs des comptabilités nationales. On suppose que les évolutions mesurées traduisent une évolution économique effective et non les limites des mesures statistiques utilisées.

[^3]: Une différence démographique importante subsiste entre les pays puisque on ne prend pas en compte le partage de la population entre actifs et inactifs (jeunes, séniors, adultes dans l'inactivité).

Le contraste à l'intérieur de la zone euro est important, entre les Pays-Bas (un écart de 7% avec les Etats Unis en 2024) et l'Espagne (un écart de 36%). C'est depuis 2008 que les choses se jouent (onglet relatif aux USA sur la @fig-pibcap), même si pour certains pays (la France et l’Italie notamment) le décrochage se produit antérieurement (début des années 1990, en partie pour des raisons démographiques).

Depuis 2008, les Pays-Bas ont perdu 12 points de PIB par tête par rapport aux Etats-Unis, l'Allemagne et la France 11 points, l'Italie et l'Espagne 16 et 10 points respectivement (10 point pour la Zone euro). C'est la simultanéité de cette évolution qui la rend frappante, d'autant qu'elle ne se limite pas à la zone euro (ou l'UE), comme l'indiquent les trajectoire de la Suisse ou du Royaume-Uni.

De nombreuses explications ont été avancées pour expliquer le décrochage depuis 2008. On peut citer :

-   Une explication "keynésienne" selon laquelle les politiques macroéconomiques menées après la crise financière de 2008 et les conséquences de la crise des dettes souveraines en zone euro qui ont conduit à un sous-investissement privé et public et une sur-épargne du continent conduisant à un accroissement de la position nette extérieur et une réduction relative des dettes publiques plus importante en zone Euro qu'ailleurs [voir @iags2019; @dap2024; @blot2025]. La crise sanitaire de 2020 a pu avoir des conséquences différenciées accentuant des trajectoires divergentes depuis 2008.

-   Une explication structurelle situant dans l'incomplétude de la zone euro, et en particulier la fragmentation financière, l'absence d'un marché de capitaux intégré, une trop grande importance du crédit bancaire dans le financement des entreprises, une concurrence insuffisante sur les marchés des biens et des services, un empilement normatif qui empêcheraient les entreprises européennes d'investir et d'innover et de prendre leur place dans la compétition technologique [voir @draghi2024].

-   Dans la même lignée, l'explication selon laquelle la lourdeur du système social et la redistribution qu'elle implique pèserait sur l'offre de travail (taux d'activité, nombre d'heures de travail, fuite des innovateurs). Cet argument un peu ancien peine à rendre compte de la hausse des taux d'acitivité récente et n'apporte pas d'éléments justifiant l'exécédent courant de la zone euro, s'appliquant plus à certains pays (dont la France).

-   Une explication par le prix de l'énergie. Depuis une décennie, un séquence d'évènement a contributé à creuser le prix e l'énergie entre les Etats-Unis et l'Europe : l'exploitation du gaz de schiste sur le continent Nord Américain ; la montée en puissance du marché carbone EU ETS (*European Union Emission Trade System*) et du prix du carbone (principalement à partir du début de 2021 où le prix de la tonne de CO~2~ passe de moins de 20€ à plus de 70€ durablement [@epaulard2024]) ; la dépendance à l'énergie importée de Russie (principalement pour l'Allemagne) dont les conséquences ont été massives après l'invasion de l'Ukraine par la Russie [voir @geerolf2022] ; l'*Inflation Reduction Act* [2022, voir @cae2023ira]. Ces facteurs ont conduit à un prix de l'énergie 3 fois plus élevé en Europe qu'aux Etats-Unis en 2024 [@draghi2024; @epaulard2024].

-   Une explication technologique, selon laquelle le décrochage est lié à une vague d'innovation (digitalisation et services réseaux, robotique, intelligence artificielle, calcul massif mais aussi dans d'autres secteurs comme la production d'énergie (éolienne, panneaux solaires), les batteries électriques, biotechnologies) dont le cœur se situe entre la Chine et les Etats-Unis. Ainsi, l'écart se creuse sur la productivité par la combinaison d'un système éducatif supérieur très performant, d'un système de financement de l'innovation efficace, d'une commande publique importante qui complète un marché à même de les absorber, d'un protectionnisme agressif sur ces technologies et de technologies partiellement caractérisées par des effets de réseau important [@dric2025; @dric2022; @dric2016].

## L'angle de la distribution des revenus

### Quelques remarques de méthode

Les explications rappelées ci-dessus partagent un diagnostic établi sur la base du PIB agrégé, ou moyen et pour la plupart sont sous l'angle de la production ou de la demande agrégée. Or, les évolutions des revenus sont aussi pertinentes pour juger de la capacité d'une économie à fournir un revenu à ses citoyens et peut être déclinée par catégorie de revenu.

Si le revenu découle de la production et de la rémunération des facteurs, d'autres éléments le modifient. En particulier, la contribution de l'extérieur au revenu national, suivant les termes de l'échange et l'évolution de la balance courante. Nous mettons de côté ces éléments pour nous intéresser aux aspects de redistribution : pour les revenus les plus faibles, la redistribution (prestations sociales) nette des contributions (impôts directs et indirects) augmente le revenu primaire tiré des revenus d'activité. Pour les plus hauts revenus, la redistribution est généralement un prélèvement net sur le revenu primaire. Cependant, l'épargne accumulée vient accroître le revenu primaire tiré du travail et contribue à travers les revenus du capital au revenu.

Le travail titanesque accompli par les chercheur du *World Inequality Database* (WID), avec des contributions importantes de @piketty2018, permet d'approcher ces notions pour de nombreux pays, avec une grande profondeur temporelle. Les données fournies par le WID surpassent même celles disponibles auprès des instituts statistiques nationaux ou internationaux, et selon les auteurs eux-mêmes (<https://wid.world/methodology/>), la construction de données aussi complètes demande des hypothèses audacieuses. Ils justifient ces choix comme une preuve du concept et veulent inciter les instituts statistiques nationaux à publier de meilleures données afin de mettre à disposition toute l'information nécessaire pour comprendre les évolutions des inégalités de revenu. Ainsi, le concept de comptes nationaux distribués doit beaucoup aux chercheurs du WID et s'impose aux constructeurs des comptes nationaux [@insee2023].

Pour un contrepoint aux évolutions agrégées ou sectorielles, nous utilisons ici les notions de revenu pre taxation, c'est-à-dire la variable *ptinc* dans le WID, proche du revenu primaire, mais augmentée des revenus différés (les pensions de retraite). En traitant les pensions de retraite comme un revenu du travail, les cotisations retraites ne sont pas considérées comme un prélèvement (redistribué ensuite) mais une épargne, ce qui est une convention bienvenue pour les comparaisons internationales, puisque dans de nombreux pays l'épargne retraite n'est pas considérée comme obligatoire même lorsqu'elle est imposée par l'entreprise. Les revenus post taxation et distribution, la variable *diinc* dans le WID, sont une construction complexe, proche de la notion de revenu disponible ajusté, c'est-à-dire le revenu moins les impôts, y compris les impôts indirects, et augmenté des dépenses publiques dont bénéficient les individus, qu'elles soient individualisables et transférées en monnaie, ou qu'elles soient collectives et imputées selon une série de conventions. La complexité, ou le recours à des conventions, n'est pas problématique, mais à ce stade, les choix faits par les chercheurs du WID ne sont pas complètement discutés. On ne peut que souhaiter que le travail engagé se poursuive et se diffuse afin de pouvoir disposer d'éléments de comparaison aussi solides que possible[^4].

[^4]: La cohérence entre les évolutions des revenus retracés dans le WID et les évolutions de PIB décrites par les comptabilités nationales n'est en particulier pas assurée.

Comme pour les données agrégées, nous considérons les évolutions en valeur déflatées (par le déflateur du PIB en général, non différenciées selon les catégories de revenus, suivant le WID), ramenées à la parité de pouvoir d'achat (2023 comme une année de référence). Comme évoqué en note de bas de page, ces choix masquent des difficultés de méthode non résolus à ce stade, et en ajoutent quelques uns, comme par exemple le fait de ne pas différencier les indices de prix par catégorie de revenu alors que les coefficients budgétaires sont hétérogènes.

### Le décrochage des plus riches européens

```{r, include=FALSE}
dina <- ofce::source_data("wid.R")$dina

labels <- c(p0p50 = "50% les moins riches",
            p50p90 = "des 50% les moins riches aux 10% les plus riches",
            p50p99 = "des 50% les moins riches aux 1% les plus riches",
            p90p99 = "des 90% les moins riches aux 1% les plus riches",
            p90p100 = "10% les plus riches",
            p99p100 = "1% les plus riches")

gg1 <- function(pays, variable = "aptincj992", type = "eurppp",
               percentile=c("p0p50", "p50p90", "p90p100")) {
  if(type=="eurppp") {
    interactive <- geom_point_interactive(
      aes( tooltip = tooltip,
           data_id = year, fill = country),
      shape=21, color="white", stroke = 0.1, size=0.75 ,
      hover_nearest = TRUE)
    ylab <- ylab("€ 2023, ppp, par tête par an")

    scaley <- scale_y_log10(
      limits = c(7500, 500000),
      labels = scales::label_number(scale=1/1000, suffix = "k"),
      breaks = c(20000, 30000, 50000, 100000, 150000, 200000),
      guide  = guide_axis_logticks())
  }
  if(type == "us1") {
    ylab <- ylab("€ 2023, ppp, par tête par an, USA = 1")
    scaley <- scale_y_log10(
      limits = c(.4, 2),
      guide  = guide_axis_logticks())
    interactive <- geom_point_interactive(
      aes( tooltip = tooltip,
           data_id = year, fill = country),
      shape=21, color="white", stroke = 0.1, size=0.75 ,
      hover_nearest = TRUE)
  }
  ggplot(dina |> filter(country%in%pays,
                        variable %in% !!variable,
                        type %in% !!type,
                        percentile %in% !!percentile)) +
    aes(x=year, y=revenu, color = country) +
    geom_line(linewidth = 0.5)+
    ggrepel::geom_text_repel(
      aes(label=label),
      size= 3 ,
      hjust =  0.5,
      nudge_x = 1.5,
      na.rm=TRUE,
      max.overlaps = Inf,
      min.segment.length=0.1,
      segment.size = 0.1,
      xlim = c(2023.5, Inf),
      direction = "y"
    ) +
    interactive +
    facet_wrap(
      vars(percentile), labeller = as_labeller(labels) )+
    scaley +
    scale_x_continuous(
      breaks = seq(1980, 2020, by = 10),
      expand = expansion(add = c(2, 6) ) ) +
    ylab +
    xlab(NULL) +
    ofce::scale_color_pays("iso2c") +
    guides(color = "none", fill = "none") +
    theme_ofce(
      panel.spacing = unit(12, 'pt'),
      axis.text = marquee::element_marquee(size = rel(0.7)),
      axis.text.x = marquee::element_marquee( hjust = 0, margin = margin(t=0)),
      axis.ticks.length.y = unit(-2, 'pt'),
      strip.text.x = marquee::element_marquee(size=rel(0.7), hjust = 0, width = 0.9),
      strip.text.y = marquee::element_marquee(size=rel(0.7), hjust = 0)) +
    ofce::ofce_caption(
      source = "World Inequality Database (WID), téléchargée le 10 mai 2025", ofce = FALSE, author = TRUE,
      code = "https://github.com/xtimbeau/decrochage",
      note = "Le revenu pré-taxation est la variable *ptinc*, le revenu post taxation est *diinc* ; pour le groupe d'âge *992* ; le partage *j* ; en euro 2023 constant, converti en parité pouvoir d'achat (*xlceupi999*) pour l'année 2023. Le revenu (pré et post) inclu les retraites (voir https://wid.world/codes-dictionary/). La zone euro (à 19 pays) est reconstituée à partir des données en centiles de chaque Etat membre" )
}
```

```{r, results="asis"}
#| label: fig-percentile
#| fig-cap: Revenus avant et après taxation, par catégories de revenu
#| fig-asp: 0.9

plots <- list(
  "Revenu ajusté, après taxes et redistribution" = list(
    "USA, EUZ, GB, CHE" = gg1(c("US","EUZ","GB", "CH"), "adiincj992"),
    "DEU, FRA, ITA, ESP, NLD" = gg1(c("DE","FR","IT","ES","NL"), "adiincj992"),
    "relatif aux USA" = gg1(c("US","DE","FR","IT","ES","NL", "GB", "CHE"), "adiincj992", "us1") ),
    "Revenu primaire avant taxes et redistribution" = list(
    "USA, EUZ, GB,CHE" = gg1(c("US","EUZ","GB", "CH"), "aptincj992"),
    "DEU, FRA, ITA, ESP, NLD" = gg1(c("DE","FR","IT","ES","NL"), "aptincj992"),
    "relatif aux USA" = gg1(c("US", "DE","FR","IT","ES","NL", "GB", "CHE"), "aptincj992", "us1"))
)

tabsetize2(plots, girafy=TRUE, r=1.5)

```

```{r, results="asis"}

download_margin(dina |> select(year, country, percentile,variable, type, revenu))

```

La @fig-percentile raconte une histoire assez éloignée de la @fig-pibcap, comme déjà noté en 2014 par @timbeau2014 sur une version moins complète du WID. Pour les catégories de revenus le plus faibles, l'avantage revient à la vieille Europe. Ainsi, 4 constats assez spectaculaires s'imposent :

1.  Pour la zone euro dans son ensemble, comme pour la majorité des Etats membres, le revenu moyen par individu des 50% les moins riches est plus élevé qu'aux Etats-Unis (@fig-percentile, notamment l'onglet *relatif aux USA)*. L'Italie présente une trajectoire de décrochage manifeste, que ce soit par rapport aux Etats-Unis mais aussi aux pays de la zone euro. La France dans une situation plutôt favorable, bien que les 10 dernières années aient vu une progression faible de ces revenus. Les inégalités sont moins marquées en zone euro qu'aux USA (@fig-evol) et sont plutôt stables en moyenne (les inégalités se sont réduites en France et en Espagne, s'accroissent aux Pays-Bas et en Italie).

2.  Paradoxalement, pour la moitié de la population, le constat tient pour les revenus primaires (y compris retraites) (@fig-percentile, onglet Revenu primaire avant taxes et redistribution). Ainsi, ce n'est pas la redistribution (prestations et dépenses publiques, nettes des impôts) qui permet aux 50% les moins riches de bénéficier d'un niveau de vie supérieur que les 50% les moins riches aux Etats-Unis, mais les revenus tirés de l'activité, qu'ils soient immédiats ou différés. Probablement, les systèmes de retraites européens jouent un rôle important mais, au delà, les systèmes de rémunération plancher (salaire minimum) et un encadrement des conditions de temps partiel participent aussi à cette caractéristique. Comme l'indique la @fig-prepost, la redistribution pour les 50% les moins riches s'accroît de 1980 à aujourd'hui, dans tous les pays et de façon assez homogène. La trajectoire de la France et des Etats-Unis sont à ce titre assez proches. Les Pays-Bas ou la Suisse ont un arrangement institutionnel qui conduit à une rémunération relative (instantanée et différée) des plus pauvres particulièrement élevée.

3.  Pour les catégories de revenus entre les 50% les moins riches et les 10% les plus riches (soit 40% de la population), le diagnostic est mitigé. En revenus primaires, le décrochage est présent pour certains pays, mais moins flagrant que lorsqu'on regarde le PIB moyen. Si le PIB moyen de la France a décroché de 12 points de PIB, le décrochage n'est que de 4 points pour les revenus intermédiaires. Alors que la contribution nette à la redistribution de cette catégorie de la population est presque constante dans les pays de la zone euro (et proche de 0 selon la @fig-prepost), la catégorie équivalente aux Etats Unis bénéficie maintenant d'une contribution nette positive de la redistribution.

4.  Pour les 10% les plus riches, l'écart s'est fortement creusé, alors qu'il était déjà important en 1980, à part pour l'Allemagne (@fig-percentile, onglet relatif aux USA). Si le décrochage se produit, c'est donc dans ces catégories de revenu. La contribution de la redistribution à cet écart n'est pas très différente aux Etat-Unis et en Europe : les revenus des 10% plus riches sont plus taxés en Europe qu'aux Etats-Unis, dans une proportion importante, tout comme ceux des 1% les plus riches, et les évolutions de ces taxations sont assez parallèles. La France et la Suisse sont des cas particuliers avec une hausse très substantielle de la taxation des plus riches (les 1% notamment).

```{r, include=FALSE}
dina <- ofce::source_data("wid.R")$dina

evol <- dina |>
  filter(type=="eurppp") |>
  group_by(variable, year, country) |>
  summarize(s10s50 = revenu[percentile=="p90p100"]/revenu[percentile=="p0p50"]) |>
  ungroup() |>
  mutate(
    clabel = countrycode::countrycode(country, "iso2c", "country.name.fr"),
    clabel = ifelse(country=="EUZ", "Zone euro", clabel),
    label = ifelse(year==max(year), country, NA_character_),
    lline = glue("Revenu moyen des 10% les plus riches sur le revenu moyen des 50% les plus pauvres : <b>{round(s10s50,2)}</b>"),
    tooltip = glue(
    "<b>{clabel}</b><br>
    {floor(year)}<br>
    {lline}"))

gge <- function(pays, variable = "aptincj992") {
  ggplot(evol |> filter(variable==!!variable, country %in% !!pays)) +
  aes(x=year, y=s10s50, color = country) +
    geom_line(linewidth = 0.5)+
    ggrepel::geom_text_repel(
      aes(label=label),
      size= 3 ,
      hjust =  0.5,
      nudge_x = 2,
      na.rm=TRUE,
      max.overlaps = Inf,
      min.segment.length=0.1,
      segment.size = 0.1,
      xlim = c(2023.5, Inf),
      direction = "y"
    ) +
    geom_point_interactive(
      aes( tooltip = tooltip,
           data_id = year, fill = country),
      shape=21, color="white", stroke = 0.25,
      hover_nearest = TRUE) +
    scale_y_log10(
      limits = c(2,20),
      guide  = guide_axis_logticks()) +
    scale_x_continuous(
      breaks = seq(1980, 2020, by = 10),
      expand = expansion(add = c(2, 6) ) ) +
    ylab("ratio s10/s50") +
    xlab(NULL) +
    ofce::scale_color_pays("iso2c") +
    guides(color = "none", fill = "none") +
    theme_ofce(
      panel.spacing = unit(12, 'pt'),
      axis.text = marquee::element_marquee(size = rel(0.7)),
      axis.text.x = marquee::element_marquee( hjust = 0, margin = margin(t=0)),
      axis.ticks.length.y = unit(-2, 'pt'),
      strip.text.x = marquee::element_marquee(size=rel(0.7), hjust = 0, width = 0.9),
      strip.text.y = marquee::element_marquee(size=rel(0.7), hjust = 0)) +
    ofce::ofce_caption(
      source = "World Inequality Database (WID), téléchargée le 10 mai 2025", ofce = FALSE, author = TRUE,
      code = "https://github.com/xtimbeau/decrochage",
      note = "Si la distribution des revenus était parfaitement égale, le ratio serait égal à 1. Plus le ratio est grand plus les inégalités sont marquées. Les pensions de retraite sont traitées comme revenu primaire ce qui est une meilleure convention que celle pratiquée par l'OCDE. Cette convention réduit les inégalités primaires généralement retenues pour la France, qui découle de la prise en compte du système de retraite comme une redistribution." )
  }

eplots <- list(
  "Revenu ajusté, après taxes et redistribution" = list(
    "USA, EUZ, GB, CHE" = gge(c("US","EUZ","GB", "CH"), "adiincj992"),
    "DEU, FRA, ITA, ESP, NLD" = gge(c("DE","FR","IT","ES","NL"), "adiincj992") ),
    "Revenu primaire avant taxes et redistribution" = list(
    "USA, EUZ, GB,CHE" = gge(c("US","EUZ","GB", "CH"), "aptincj992"),
    "DEU, FRA, ITA, ESP, NLD" = gge(c("DE","FR","IT","ES","NL"), "aptincj992") )
)

```

```{r, results="asis"}
#| label: fig-evol
#| fig-cap: Evolution des inégalités de revenu (S10/S50)
#| fig-asp: 0.9

tabsetize2(eplots, girafy = TRUE, asp = 0.9)
```

```{r, results="asis"}

download_margin(evol |> select(year, country, variable, s10s50))

```

La @fig-compdis présente les évolutions des 40 dernières années d'une façon synthétique en construisant une distribution globale des pays considérés (USA, GB, Suisse et zone euro) et en calculant les déciles de cette distribution. En 1980, les Etats-Unis étaient caractérisés (après redistribution) par une part plus importante des plus riches (le dernier décile de revenu) et une répartition plutôt homogène des autres catégories. Les pays européens quant a eux étaient soit moins développés (l'Espagne, l'Italie, les autres pays de la zone euro), fortement représentés parmi les premiers déciles, soit développés (les Pays-Bas, la Suisse, l'Allemagne et la France) sous représentés (voire pas du tout pour certains) dans les premiers déciles et des effectifs dans le dernier décile supérieurs à leurs parts dans la population totale.

```{r, results="asis"}
#| label: fig-prepost
#| fig-cap: Ratio revenu ajusté sur revenu primaire par catégorie de revenu
#| fig-asp: 0.9

ggpp <- function(pays, percentile=c("p0p50", "p50p90", "p90p99", "p99p100")) {
  ggplot(dina |>
         filter(type=="eurppp",
                variable == "aptincj992",
                country %in% pays,
                percentile %in% !!percentile)) +
  aes(x =year, y = prepost, color = country, group=country) +
  geom_hline(yintercept = 1, linewidth = 0.25, color= "grey") +
  geom_line_interactive(aes(
    data_id = country)) +
  facet_wrap(vars(percentile), labeller = as_labeller(labels), nrow = 1) +
  ofce::scale_color_pays("iso2c") +
    ggrepel::geom_text_repel(
      aes(label=label),
      size= 3 ,
      hjust =  0.5,
      nudge_x = 1.5,
      na.rm=TRUE,
      max.overlaps = Inf,
      min.segment.length=0.1,
      segment.size = 0.1,
      xlim = c(2023.5, Inf),
      direction = "y"
    )+
    scale_x_continuous(
      breaks = seq(1980, 2020, by = 20),
      expand = expansion(add = c(2, 10) ) ) +
    scale_y_log10(
      limits = c(0.5, 2),
      breaks = seq(0.5, 2, 0.25),
      guide  = guide_axis_logticks()) +
    guides(color = "none", fill = "none") +
    xlab(NULL)+
    ylab("ratio diinc/ptinc")+
    theme_ofce(
      panel.spacing = unit(12, 'pt'),
      axis.text = marquee::element_marquee(size = rel(0.7)),
      axis.text.x = marquee::element_marquee( hjust = 0, margin = margin(t=0)),
      axis.ticks.length.y = unit(-2, 'pt'),
      strip.text.x = marquee::element_marquee(size=rel(0.7), hjust = 0, width = 0.9),
      strip.text.y = marquee::element_marquee(size=rel(0.7), hjust = 0)) +
    ofce::ofce_caption(
      source = "World Inequality Database (WID), téléchargée le 10 mai 2025", ofce = FALSE, author = TRUE,
      code = "https://github.com/xtimbeau/decrochage",
      note = "Ratio entre *diinc* (revenu disponible ajusté, après taxation et redistribution) et *ptinc* (revenu primaire incluant les salaires différés) pour différentes catégories de revenus. Lorsque le ratio est égal à 1, les individus reçoivent autant de prestations et de dépenses publiques qu'ils payent d'impôts (directs et indirects). Lorsque le ratio est supérieur à 1, ils reçoivent plus qu'ils ne payent. Inversement, lorsque le ratio est inférieur à 1, ils ont une contribution nette positive à la resdistribution." )
}

plots <- list(
    "USA, EUZ, GB, CHE" = ggpp(c("US","EUZ","GB", "CH")),
    "DEU, FRA, ITA, ESP, NLD" = ggpp(c("DE","FR","IT","ES","NL")) )

tabsetize(plots)
```

En 2023, la situation a radicalement changé. Les seuils des déciles se sont étirés fortement vers les hauts revenus. Le seuil inférieur du dernier décile (49,8k€) de 1980 se situe dans le 7^ème^ décile de la distribution de 2023. La part des Etats-Unis dans le premier décile ainsi que dans le dernier a considérablement augmentée (avec un *odd ratio –* la part de la population des USA dans le décile sur la part des USA dans la population totale – de presque 1,5 pour le dernier décile), indiquant une franche polarisation des revenus aux Etats-Unis. L'Espagne – comme les *Autres zone euro* – a accompli un glissement de la distribution des revenus vers la droite, indiquant une progression dans l'échelle des revenus globaux. L'Italie a, au contraire, une part plus importante de sa population dans les premiers déciles (près de 10% de sa population est passée en dessous de la médiane globale entre 1980 et 2023). Quant aux pays les plus développés d'Europe, à l'exception des Pays-Bas, ils se retrouvent concentrés dans l'espace compris entre les 3 premier déciles et les deux derniers déciles.

L'Europe, à l'exception de l'Italie a proposé un modèle de développement permettant aux plus pauvres de voir significativement augmenter leurs revenus avant et après redistribution. Pour les revenus intermédiaires, l'Europe apparaît comme un territoire plus certain et propice que les USA. Mais les plus riches sont désormais de plus en plus américains, néerlandais ou britanniques. Le cas des Pays-Bas est intriguant : ils maintiennent un haut niveau de vie des plus pauvres, une redistribution généreuse, mais parviennent à alléger la contribution nette des plus riches à la redistribution. Etre le paradis fiscal de la zone euro et bénéficier d'un important excédent commercial liè à sa position de point d'entrée des flux commerciaux en Europe aide sans doute ce miracle (et le rend difficilement généralisable au reste de la zone euro).

```{r, include=FALSE}
full_dec <- ofce::source_data("wid.R")$fdec

fnum <- function(x) formatC(x, big.mark =" ", decimal.mark=",", format = "fg", digits=2, width=1)

deciles <- full_dec |>
  group_by(decile, year, country3, variable) |>
  summarise(
    revenu_moy = sum(popr*revenu)/sum(popr),
    seuilp = first(seuilp),
    seuilm = first(seuilm)
  ) |>
  ungroup() |>
  mutate(
    seuilm = ifelse(seuilm<0, 0, seuilm),
    label = str_c("[", fnum(seuilm), "->", fnum(seuilp), "]") ) |>
  select(variable, decile, year, country3, label, revenu_moy)

pops <- full_dec |>
  filter(year %in% c(1980, 2023),
         variable %in% "aptincj992") |>
  group_by(year, country3) |>
  summarize(spopr = sum(popr),
            .groups = "drop") |>
  arrange(desc(country3))

breaks <- pops |>
  filter(year=="2023") |>
  mutate(cpopr = cumsum(spopr)/10) |>
  pull(cpopr, name = country3)

full_dec <- full_dec |>
  filter(year %in% c(1980,2023)) |>
  left_join(deciles, by=c("country3", "decile", "year", "variable")) |>
  left_join(pops, by = c("country3", "year")) |>
  mutate(
    clabel = countrycode::countrycode(country3, "iso2c", "country.name.fr"),
    clabel = ifelse(country3=="Autres\nEUZ", "Autres EUZ", clabel),
    tooltip = glue(
    "<b>Décile global {str_remove(decile, 'd')} année {year}</b>
     Revenu entre {label}
     <b>{clabel}</b>
     Part dans la population globale: {round(100*spopr)}%
     Part dans le decile: {round(popr*10*100)}%
     Revenu moyen: {fnum(revenu_moy)} euros 2023 ppp"))

gg2 <- map(c(
  "Revenu ajusté, après taxes et redistribution" = "adiincj992",
  "Revenu primaire avant taxes et redistribution" = "aptincj992"), ~{
    ggplot(full_dec |> filter(variable==.x)) +
      aes(x = decile, y = popr, fill = country3)+
      facet_wrap( vars(year) )+
      geom_col_interactive(
        aes(tooltip = tooltip,
          data_id = country3, fill = country3),
          alpha=0.7, color = "white", linewidth =0.1, hover_nearest=TRUE) +
    geom_text(aes(label=if_else(decile=="d1", country3, "")),
                  position = position_stack(vjust=0.5),
            size = 2.5, col="white") +
    scale_y_continuous(
      breaks = breaks,
      labels = c("4%", "5%", "", "6%", "7%", "8%", "", "9%", "10%")) +
    ylab(NULL) +
    xlab(NULL) +
    theme_ofce(
      panel.grid.major.x = element_blank(),
      panel.grid.major.y = element_line(color = "grey", linewidth = 0.5)  )+
    scale_color_pays("iso2c") +
   #scale_fill_manual(values = c(PrettyCols::prettycols("Teals", 6), "orchid3", "royalblue4")) +
    guides(fill="none") +
    ofce_caption(
      source = "World Inequality Database (WID), téléchargée le 10 mai 2025", ofce = FALSE, author = TRUE,
      code = "https://github.com/xtimbeau/decrochage",
      note = "La distribution globale est construite à partir des centiles de distribution de chaque pays/zones et pour le revenu ajusté (*diinc*) et primaire (*ptinc*) en pondérant par la population du centile. Une intrapolation est faite au millile pour lisser les répartitions entre déciles (voir le code). L'axe des *y* représente les parts des populations des pays dans la population totale en 2023 dans l'ordre d'affichage des pays."
    )

  })

# data <- full_dec |>
#          group_by(year, variable, decile) |>
#          arrange(desc(country3)) |>
#          mutate(
#            seuilm = ifelse(seuilm<=10, 10, seuilm),
#            y = popr/(log(seuilp) - log(seuilm)),
#            ymax = cumsum(y),
#            ymin = lag(ymax, default = 0) ) |>
#   ungroup()
#
# ggplot(data ) +
#   facet_grid(rows = vars(year), cols = vars(variable))+
#   geom_rect(
#     aes(xmin = seuilm, xmax = seuilp, ymin = ymin, ymax = ymax, fill=country3 ), col="white") +
#   scale_x_log10(limits = c(5000, NA))+
#   coord_flip()

```

```{r, results="asis"}
#| label: fig-compdis
#| fig-cap: Distribution globale des revenus (EUZ, UK, CHE,           USA) en 2023 et 1980
#| fig-asp: 0.9

tabsetize(gg2)

```

```{r, results="asis"}

download_margin(full_dec |> select(year, country3, decile, variable, popr, revenu, seuilm, seuilp, revenu_moy))

```

### Pourquoi le vote Trump II ?

Ces éléments permettent de revenir sur l'analyse souvent faite d'une performance des Etats-Unis particulièrement forte. Si cette performance est incontestable, elle n'a pas du tout profité aux plus pauvres. Ceci peut expliquer le sentiment d'une situation économique très dégradé sous le mandat Biden (même si les évolutions ne sont pas le fait directement des présidents et de leurs politiques mais résultent d'évènements externes) et en partie le vote Trump, sans pour autant négliger l'importante littérature sur le sujet du vote aux Etats-Unis – et les nombreux arguments qui y sont déployés, comme les excès de la mondialisation, la radicalisation des opinions politiques autour du climat, la révolution conservatrice au *wokisme* et bien d'autres. Pourtant, un zoom de la @fig-percentile présenté sur la @fig-zoom indique une croissance du revenu des 50% les moins riches assez nette de 2018 à 2020, interrompue ensuite, avec le COVID et la hausse des prix de l'énergie, un résultat proche de celui de @frbsf2025 à partir de sources différentes.

```{r}
#| label: fig-zoom
#| fig-cap: Zoom sur la période 2008-2023, USA
#| fig-asp: 0.6

g50 <- gg1(c("US"), "adiincj992", percentile=c("p0p50")) +
  scale_x_continuous(
    limits=c(2008, NA), breaks = seq(2008, 2020, by = 4),
    expand = expansion(add = c(2, 2) ) ) +
  scale_y_log10(
        limits = c(15000, 30000) ,
        labels = scales::label_number(scale=1/1000, suffix = "k"),
        guide  = guide_axis_logticks()) +
  facet_wrap(
      vars(percentile),
      labeller = as_labeller(labels),
      scale = "free_y") -
  annotate("rect", xmin=2009, xmax=2016.9, ymax=Inf, ymin=15000, fill="lightblue", alpha=0.5) -
  annotate("rect", xmin=2017, xmax=2020.9, ymax=Inf, ymin=15000, fill="pink", alpha=0.5) -
  annotate("rect", xmin=2021, xmax=2024.9, ymax=Inf, ymin=15000, fill="lightblue", alpha=0.5)+
  annotate("text", x=2013, y=30000, label="Obama", hjust = 0.5, vjust=1, size = 2)+
  annotate("text", x=2019, y=30000, label="Trump I", hjust = 0.5, vjust=1, size = 2)+
  annotate("text", x=2023, y=30000, label="Biden", hjust = 0.5, vjust=1, size = 2) +
  ofce_caption(
    source = NULL, ofce = FALSE, author = TRUE,
    code = NULL)

g5090 <- gg1(c("US"), "adiincj992", percentile=c("p50p90")) +
  scale_x_continuous(
    limits=c(2008, NA), breaks = seq(2008, 2020, by = 4),
    expand = expansion(add = c(2, 2) ) ) +
  scale_y_log10(
        limits = c(50000, 70000) ,
        labels = scales::label_number(scale=1/1000, suffix = "k"),
        guide  = guide_axis_logticks()) +
  facet_wrap(
      vars(percentile),
      labeller = as_labeller(labels),
      scale = "free_y") -
  annotate("rect", xmin=2009, xmax=2016.9, ymax=Inf, ymin=50000, fill="lightblue", alpha=0.5) -
  annotate("rect", xmin=2017, xmax=2020.9, ymax=Inf, ymin=50000, fill="pink", alpha=0.5) -
  annotate("rect", xmin=2021, xmax=2024.9, ymax=Inf, ymin=50000, fill="lightblue", alpha=0.5)+
  annotate("text", x=2013, y=70000, label="Obama", hjust = 0.5, vjust=1, size = 2)+
  annotate("text", x=2019, y=70000, label="Trump I", hjust = 0.5, vjust=1, size = 2)+
  annotate("text", x=2023, y=70000, label="Biden", hjust = 0.5, vjust=1, size = 2)+
  ylab(NULL) +
  ofce_caption(
    source = NULL, ofce = FALSE, author = TRUE,
    code = NULL)

g90100 <- gg1(c("US"), "adiincj992", percentile=c("p90p100")) +
  scale_x_continuous(
    limits=c(2008, NA), breaks = seq(2008, 2020, by = 4),
    expand = expansion(add = c(2, 2) ) ) +
  scale_y_log10(
        limits = c(175000, 250000) ,
        labels = scales::label_number(scale=1/1000, suffix = "k"),
        guide  = guide_axis_logticks()) +
  facet_wrap(
      vars(percentile),
      labeller = as_labeller(labels),
      scale = "free_y") -
  annotate("rect", xmin=2009, xmax=2016.9, ymax=Inf, ymin=175000, fill="lightblue", alpha=0.5) -
  annotate("rect", xmin=2017, xmax=2020.9, ymax=Inf, ymin=175000, fill="pink", alpha=0.5) -
  annotate("rect", xmin=2021, xmax=2024.9, ymax=Inf, ymin=175000, fill="lightblue", alpha=0.5) +
  annotate("text", x=2013, y=250000, label="Obama", hjust = 0.5, vjust=1, size = 2)+
  annotate("text", x=2019, y=250000, label="Trump I", hjust = 0.5, vjust=1, size = 2)+
  annotate("text", x=2023, y=250000, label="Biden", hjust = 0.5, vjust=1, size = 2)+
  ylab(NULL) +
  ofce_caption(
    source = NULL, ofce = FALSE, author = TRUE,
    code = NULL)

ggg <- g50 + g5090 + g90100 +
  plot_annotation(caption="*Note* : Les échelles de revenus (axes des *y*) sont différentes pour chaque catégorie de revenu, les valeurs annuelles sont affichées en milieu d'année.   \n*Source* : World Inequality Database (WID), téléchargée le 10 mai 2025",
                  theme = theme_ofce())

girafy(ggg)
```

Ce phénomène est moins net pour les 40% suivants, mais depuis 2008, la croissance du revenu de la catégorie entre les 50% les moins riches aux 10% les plus riches a été plutôt faible comparée aux périodes précédentes. Le même ralentissement s'observe pour les 10% les plus riches, mais il est moins net, ce qui conduit à un accroissement des inégalités entre 2020 et 2023 (le ratio revenu moyen des 10% les plus riches au revenu moyen des 50% les moins riches passe de 8,49 à 9,05 aux Etats-Unis, contre 3,43 et 3,59 en France, @fig-evol) alors qu'il avait baissé de 2016 à 2020 (de 9,90 à 8,49). Depuis 2008, ce ratio est plus élevé et a augmenté aux Etats-Unis (8,91 en 2008), alors qu'il a diminué en Allemagne (de 5,21 à 4,97) ou en France (de 4,22 à 3,59). Du point de vue d'un Américain médian, la période récente n’est pas du tout favorable et la performance économique enviée de ce côté-ci de l'Atlantique n'est pas partagée le ling de la distribution des revenus.

Notons également que ces évolutions peuvent polluer les analyses sectorielles. Comme l'ont montré certains auteurs il y a longtemps [@godechot2012], la hausse des hautes rémunérations (en particulier dans la finance) et l'hypothèse assimilant productivité marginale et salaire individuel imputent à tort les gains de productivité aux secteurs captant la rente alors que les gains peuvent provenir d'autres secteur (l'industrie, les services, la production intellectuelle). Les analyses sectorielles souffrent alors d'un biais qui peut promouvoir des recommandations erronées {{< fa square >}}
